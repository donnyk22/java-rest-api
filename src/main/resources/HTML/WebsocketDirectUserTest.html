<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>WebSocket Direct User Demo</title>

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 600px;
        margin: 40px auto;
      }
      input,
      button {
        width: 100%;
        padding: 8px;
        margin-top: 8px;
      }
      pre {
        background: #f5f5f5;
        padding: 10px;
        margin-top: 10px;
      }
    </style>
  </head>

  <body>
    <h1>WebSocket Direct User Demo</h1>
    <ul>
      <li>This client-side has subscribed to the <i>/user/queue/messages</i></li>
      <li>All message that sent to <i>/user/queue/messages</i> will be received by the specific user (by user ID)</li>
    </ul>
    </br>

    <label>JWT Token</label>
    <input
      id="jwt"
      type="text"
      placeholder="Paste Bearer token here (without 'Bearer ')"
    />

    <button onclick="connect()">Connect</button>

    <pre id="log"></pre>

    <script>
      let stompClient;

      function log(message) {
        document.getElementById("log").textContent += message + "\n";
      }

      function connect() {
        const token = document.getElementById("jwt").value.trim();

        if (!token) {
          alert("JWT token is required");
          return;
        }

        const socket = new SockJS("http://localhost:8080/ws");
        stompClient = Stomp.over(socket);

        stompClient.connect(
          { Authorization: "Bearer " + token },
          () => {
            log("‚úÖ CONNECTED");

            stompClient.subscribe("/user/queue/messages", (msg) => {
              log("üì© " + msg.body);
            });

          },
          (err) => log("‚ùå ERROR: " + err)
        );
      }
    </script>
</html>  </body>

